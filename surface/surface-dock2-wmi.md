---
title: Gérer station d’accueilSurface 2 avec WMI
description: Cet article explique comment utiliser WMI pour surveiller et gérer à distance le microprogramme, l’état de la stratégie et les données associées les plus récents sur les appareils du Dock 2 surface.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 8/05/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 2c7e4ac00eea798613335a320b21ce6fcb9f9f2d
ms.sourcegitcommit: 97e19fdcd074647bedec9efdfd3ce28e900ae2ea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/05/2020
ms.locfileid: "10916506"
---
# Gérer station d’accueilSurface 2 avec WMI

La prise en charge de WMI (Windows Management Instrumentation) fournit un large éventail d’informations de diagnostic permettant aux administrateurs informatiques de surveiller et de gérer à distance le microprogramme, l’état de stratégie et les données associées de surface Dock 2. Vous pouvez utiliser WMI avec Windows PowerShell, System Center Operations Manager et d’autres outils. Pour plus d’informations sur WMI, voir [utilisation de WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1). 

Pour activer la prise en charge de WMI, accédez au [microprogramme et aux pilotes de surface Dock 2](https://www.microsoft.com/download/details.aspx?id=101317) , puis téléchargez le package approprié:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;version # C1_x64.msi:**<br>

- Surface Pro (5e génération et version ultérieure)
- Surface Book (2ème génération et version ultérieure)
- Surface Go (toutes les générations)
- Surface Laptop (toutes les générations)

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;version # C1_arm64.msi:** <br>

- SurfaceProX

## Utilisation de WMI avec surface Dock 2

1. Pour énumérer toutes les occurrences de composant de Dock:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Pour accéder aux descriptions des propriétés de classe WMI, ouvrez une invite de commandes et entrez les commandes WMI pour lesquelles **Property** est l’une des propriétés répertoriées dans le tableau 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Par exemple:** Pour accéder à la description de la propriété **version** Common Information Model (CIM), entrez ce qui suit:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### Tableau1. Référence WMI de surface Dock 2

| Propriété         | Type   | Valeur (s) attendue (s)                                                                                                                                                                                                            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Chaîne | Microcontrôleur <br>"Concentrateur USB 1" <br>"Concentrateur USB 2" <br>"Display port hub" <br>"Contrôleur de remise énergétique" <br>"Codec audio" <br>"Contrôleur Ethernet"                                                                         | La propriété suivante répertorie le nom spécifique du composant d’appareil qui correspond aux données de la classe CIM (Common Information Model) qui les accompagnent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Chaîne | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | La propriété suivante contient le nom de l’appareil de dock auquel appartient le composant d’appareil spécifique.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Chaîne | Un numéro de série de douze (12) chiffres contenant uniquement des valeurs numériques                                                                                                                                                           | La propriété suivante enregistre le numéro de série de l’appareil de connexion jointe. Ce numéro de série est exactement le même pour tous les composants tels qu’ils appartiennent au même dispositif de fixation. Pour référence, ce numéro de série est disponible physiquement au-dessous du quai de surface.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ID               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | La propriété suivante est un ID unique qui commence à zéro (0) et compte vers le haut. Cette variable est utilisée pour la numérotation des instances WMI énumérées.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Chaîne | Pris <br>"PendingDockReattach" <br>Pas                                                                                                                                                                             | La propriété suivante décrit en détail la dernière tentative de mise à jour du microprogramme du microprogramme du composant d’appareil en question. Valeurs possibles: **réussite,** **réassociation en attente** et **échec.**<br><br><br>- **Réussite** indique qu’un nouveau microprogramme a été appliqué<br>- Le **retrait du Dock en attente** indique qu’une nouvelle mise à jour est en attente pour le composant de l’appareil, et que l’utilisateur doit détacher et rattacher le connecteur surface de l’ancrage afin d’appliquer la nouvelle mise à jour.<br>- **Échec** indique qu’une erreur légitime possible s’est produite lors du processus de la mise en attente du processus ou que le périphérique n’a pas démarré dans la version attendue. En cas d' **échec** , il ne s’agit pas d’une information indiquant que l’appareil ne fonctionne pas, mais qu’une erreur est survenue lors de la tentative de mise à jour de l’appareil. Dans ce cas, le microprogramme continuera de s’exécuter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Chaîne | Activation <br>Désactivé                                                                                                                                                                                                     | La propriété suivante indique la stratégie SEMM (surface Management Mode) actuelle du composant périphérique. Valeurs possibles: **Enabled** et **Disabled.**<br><br><br>- **Activée** indique que le système SEMM a autorisé l’appareil hôte à accéder au composant d’appareil et à l’utiliser.<br>- **Désactivé** indique que le système SEMM a interdit l’accès au composant de l’appareil et l’a empêché.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | Chaîne [] | Liste de chaînes Hex, qui peuvent chacune de «0x0000» à «0xFFFF».                                                                                                                                                        | La propriété suivante classifie l’ID de produit (PID) du composant d’appareil. Il est possible que plusieurs IDENTIFICATEURs de service apparaissent. Dans le cas d’un concentrateur USB, par exemple, les périphériques Super-Speed (SS) et High Speed (SH) sont intégrés à un «hub» singulier. Par conséquent, deux (2) PID seraient répertoriés dans ce tableau.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | booléen | True ou false                                                                                                                                                        | La propriété suivante décrit l’état de mise en service du mode de gestion de surface d’entreprise (SEMM) de l’appareil de fixation de surface. L’état de mise en service est exactement le même pour tous les composants qu’ils appartiennent au même appareil de dock. Valeurs possibles: true ou false. La valeur true indique que l’appareil de fixation de surface est actuellement géré et, de ce fait, la fonctionnalité de port peut être restreinte. Pour plus d’informations, voir le champ de propriété «PolicyState». La valeur false indique que l’appareil de l’ancrage surface n’est actuellement pas géré et qu’aucune restriction de fonctionnalité n’est imposée.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Statut           | Chaîne | OK <br>Déconnecté <br>Error <br>Manquantes <br>"DeviceHandleInUse" <br>Désactivé <br>"NotSupportedByWmi"                                                                                                             | La propriété suivante décrit l’état de la connexion du Dock à l’ordinateur hôte. Les valeurs possibles sont: **OK,** **déconnecté,** **erreur,** **manquant,** **DeviceHandleInUse,**  **désactivé** et **NotSupportedByWmi.** <br>- La fonction **OK** indique que l’appareil est correctement connecté à l’ordinateur hôte et qu’il n’y a pas de problème, ce qui empêche ses fonctionnalités. <br>- Une **connexion indique que** le connecteur surface, qui assure la connexion de tous les composants de l’appareil, n’est pas actuellement associé à l’ordinateur hôte. <br>- **Erreur** : un problème potentiel lié à l’instance d’appareil et à l’interface de l’appareil a été plus susceptible d’être étiqueté par un point d’exclamation jaune dans le gestionnaire de périphériques: consultez la propriété **statusCode** pour obtenir des informations plus détaillées sur le type d’erreur qui se produit. <br>- **Manquant** indique que l’appareil a été censé avoir été énuméré sur l’ordinateur hôte, mais pas pour une raison quelconque. La propriété **statusCode** contiendra la valeur 24 pour signaler cette situation incorrecte.<br>- **DeviceHandleInUse** indique qu’un autre processus communique actuellement avec l’appareil, ce qui empêche le fournisseur d’instances WMI (Windows Management Instrumentation) de ses demandes de communication. Essayez de réexécuter votre commande WMI. <br> - **Désactivé** indique que la stratégie de gestion des entreprises de surface actuelle (SEMM) n’est pas autorisée et qu’elle a empêché l’ordinateur hôte d’accéder au composant de l’appareil et l’utiliser. Pour plus d’informations, voir le champ de propriété **PolicyState** .<br>- **NotSupportedByWmi** indique que le Dock connecté n’est pas actuellement pris en charge par ce fournisseur WMI. Ce statut s’affichera pour le Dock de surface 1, qui n’est actuellement pas pris en charge par ce fournisseur d’instances WMI.|
| StatusCode       | UInt32 | [Code d’erreur du gestionnaire de périphériques](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) obtenu à partir de la classe WMI du CIM_LogicalDevice (dans *cimwin32. mof*) | La propriété suivante fournit le code d’erreur gestionnaire de périphériques pour le composant Dock donné. La valeur zéro (0) indique que le composant Dock fonctionne correctement; valeur supérieure à zéro (0) indique un problème ou une erreur possible avec le composant Dock. Dans la mesure où le composant Dock peut énumérer avec plusieurs interfaces d’appareil, il est possible qu’il y ait des codes d’erreur supplémentaires sur le gestionnaire de périphériques. Le champ de propriété ne répertorie que les codes d’erreur uniques, même si plusieurs sont disponibles. Le gestionnaire de périphériques étiquete l’appareil avec un point d’exclamation jaune uniquement lorsque certains codes d’erreur s’affichent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ID         | Chaîne | Une chaîne hex qui peut varier de «0x0000» à «0xFFFF».                                                                                                                                                                        | La propriété suivante note l’ID de fournisseur spécifique (VID) du composant périphérique.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Version          | Chaîne | Une chaîne de version, qui se présente sous la forme suivante: «x. y. z», où x, y et z sont des valeurs numériques.                                                                                                                            | La propriété suivante spécifie la version actuelle du microprogramme qui s’exécute actuellement sur le composant appareil.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## En savoir plus

- [Sécuriser les ports de Surface Dock 2 avec SEMM](secure-surface-dock-ports-semm.md)
- [Nouveautés de station d’accueilSurface 2.](surface-dock-whats-new.md)
- [Codes d’erreur du gestionnaire de périphériques](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Utilisation de WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?view=powershell-5.1)
